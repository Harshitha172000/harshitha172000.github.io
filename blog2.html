<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Harshitha's Blog</title>
	<link rel="stylesheet" href="fontawesome/css/all.min.css"> <!-- https://fontawesome.com/ -->
	<!--<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">  https://fonts.google.com/ -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/templatemo-xtra-blog.css" rel="stylesheet">
<!--
    
TemplateMo 553 Xtra Blog

https://templatemo.com/tm-553-xtra-blog

-->
</head>
<body>
	<header class="tm-header" id="tm-header">
        <div class="tm-header-wrapper">
            <button class="navbar-toggler" type="button" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="tm-site-header">
                
                <h1 class="text-center">Harshitha's Blog</h1>
            </div>
            <nav class="tm-nav" id="tm-nav">            
                <ul>
                    <li class="tm-nav-item"><a href="index.html" class="tm-nav-link">
                        <i class="fas fa-home"></i>
                        Home
                    </a></li>
                    <!--<li class="tm-nav-item active"><a href="post.html" class="tm-nav-link">
                        <i class="fas fa-pen"></i>
                        Posts
                    </a></li>-->
                    <li class="tm-nav-item"><a href="about.html" class="tm-nav-link">
                        <i class="fas fa-users"></i>
                        About Me
                    </a></li>
                    <!--<li class="tm-nav-item"><a href="contact.html" class="tm-nav-link">
                        <i class="far fa-comments"></i>
                        Contact 
                    </a></li>-->
                </ul>
            </nav>
            <div class="tm-mb-65">
                <a rel="nofollow" href="mailto:harshithasridhar172000@gmail.com" class="tm-social-link">
                    <i class="fa fa-envelope tm-social-icon"></i>
                </a>
                <a href="https://twitter.com/Harshit49678822" class="tm-social-link">
                    <i class="fab fa-twitter tm-social-icon"></i>
                </a>
                <a href="https://github.com/Harshitha172000" class="tm-social-link">
                    <i class="fab fa-github tm-social-icon"></i>
                </a>
                <a href="https://linkedin.com/in/harshitha-s-" class="tm-social-link">
                    <i class="fab fa-linkedin tm-social-icon"></i>
                </a>
            </div>
            <p class="tm-mb-80 pr-5 text-white">
                Hi there! I am Harshitha.
            </p>
        </div>
    </header>
    <div class="container-fluid">
        <main class="tm-main">
            <!-- Search form 
            <div class="row tm-row">
                <div class="col-12">
                    <form method="GET" class="form-inline tm-mb-80 tm-search-form">                
                        <input class="form-control tm-search-input" name="query" type="text" placeholder="Search..." aria-label="Search">
                        <button class="tm-search-button" type="submit">
                            <i class="fas fa-search tm-search-icon" aria-hidden="true"></i>
                        </button>                                
                    </form>
                </div>                
            </div> -->   
                             

            <div class="row tm-row tm-mb-40">
                <div class="col-12">                                                       
                        <div class="mb-4">
                            <h2 class="pt-2 tm-mb-40 tm-color-primary tm-post-title"> Formal Verification of DPRAM and LRU </h2>                       
                            <p class="tm-mb-40">June 1, 2021 </p>
<p>I am delighted to work with the OpenRISC community as part of the FOSSi Foundation as I will contribute to the Mor1kx CPU in its formal verification. I had outlined the tasks of verification stages and my project flow for formal verification, which I have planned to complete in my previous blog.  In this blog, I will elaborate on different formal methods that I could use in my project, and a sneak peek of my work.</p>
<p>This project is entirely dependent on Yosys tools, specifically SymbiYosys and Yosys-smtbmc. What does Yosys-smtbmc do? It applies formal methods to our code and mathematically proves that code works. If not, the solvers tell us where the code might fail. </p>
<br><h2 id="bmc-and-induction">BMC and Induction</h2>
<p>Before getting into the tool, it&#39;s essential to understand some terminologies like Bounded Model Check (BMC) and Induction. BMC is the first step in Yosys-smtbmc theorem solving. Here, the solver starts with the initial state of the design and explores all the other states that it can encounter during its transitions. This method is bounded because it is time-limited and checks only a finite number of transitions. </p>
<p>To find out additional states, we follow the Induction step. It&#39;s just like mathematical Induction, where we first consider base case n=1 and prove that. Later, we check for n states and finally n+1. BMC is like a base case for k-induction. </p>
<br><h2 id="formal-declarations">Formal Declarations</h2>
<p>For any formal verification, basic operations like assert, assume, restrict and cover play a vital role. I feel assert() and assume() are far more helpful. For a design, we need to assert some conditions to check if that holds for the design. If the design fails, it may be because the code fails or a flaw in the assertion. It is recommended to assert statements carefully.</p>
<p>To formally verify, do I need to understand the code? Definitely yes! Without knowing the code and its design states, it&#39;s impossible to assert conditions. Having an excellent exposure to design and its environment would help declare assertions quickly. We can also add constraints to the design space by including assume statements in the code.  </p>
<p>With this basic idea, it&#39;s good to move ahead with Yosys formal. I have started my project earlier and have verified tiny modules like simple DPRAM, true DPRAM, and the least recently used cache. These modules are part of the instruction cache and instruction memory management unit.</p>
<br><h2 id="formally-verifying-dual-port-ram-dpram-mor1kx">Formally Verifying Dual-Port RAM (DPRAM) - Mor1kx</h2>
<p>Mor1kx cache memory uses DPRAM to store its contents. The instruction cache is simple DPRAM based, and the instruction memory management unit is true DPRAM based. To check DPRAM&#39;s exactness, I have listed few properties:</p>
<ol>
<p>1. On a read operation, data stored at the <em>raddr</em> address in memory should be put on the output data port.</p>
<p>2. On a write operation, <em>w_data</em> has to be written to the address waddr in the memory.</p>
</ol>
<pre><code>if (<span class="hljs-name">re</span>) begin
          assume (<span class="hljs-name">mem</span>[raddr]==32’hA302)<span class="hljs-comment">;</span>
          assert (<span class="hljs-name">dout==32</span>’hA302)<span class="hljs-comment">;</span>
end
</code></pre>
<p>Asserting these properties is very simple. For reading, assume some random data at the read address in the memory, and then check if the data readout of the DPRAM is the same as the data that you have assumed. If you don&#39;t want to consider some random data, don&#39;t worry yosys does it for you. You need to create a free variable like <em> anyseq</em> or <em>anyconst </em> which generates some random constant or sequence. I am not using free variables because this creates additional registers and wires during synthesis.  </p>
<p>For a write operation, a similar procedure can be followed. Assume some random write data <em>w_data</em>. Then verify if the same data is written at the write address waddr. If you don&#39;t assume, and just check if w_data==mem[waddr], then also it&#39;s the correct way of asserting as yosys assumes some data. </p>
<p>Verifying one address location is enough to verify the entire memory space formally. Along with these main assertions, I have checked for other conditions which are design specific. </p>
<br><h2 id="formally-verifying-lru-cache-mor1kx">Formally Verifying LRU Cache - Mor1kx</h2>
<p>Having verified DPRAM, I moved onto the least recently used cache module. I first understood what algorithms exactly do, and asserted properties to verify. These are some properties which I have checked:</p>
<ol>
<p>1. Mor1kx implementation supports set associative cache. So, the LRU algorithm holds if there are at least two ways in the set.</p>
<p>2. Assuming that at a time there is only one way is accessed from the set and verifying if the output variables update the LRU accordingly.</p>
</ol>
<p>After adding these assertions to the source files, the very next step is to configure the SBY file. Mode for verification should be chosen either bmc or prove or live, etc. Along with that should specify which smtbmc engine you would prefer to use. Yosys supports engines like z3, yices, boolector, etc. One last step is to add design files and specify the top module, then you are done. On running the SBY file, you would get to know what&#39;s the result of verification.</p>
<p>We have seen that all the properties I have tested on Mor1kx&#39;s DPRAM and LRU are satisfied. Now, I will be moving on to the instruction cache verification. For the upcoming week, I plan to verify the Instruction memory management unit and Instruction fetch modules. I am hoping to find out some interesting parts of Mor1kx there.</p>





                               
                             <!-- <span class="d-block text-right tm-color-primary">Creative . Design . Business</span>-->
                        </div>
                    </div>                    
                </div>
            
                        
                        <!-- Comments 
                        <div>
                            <h2 class="tm-color-primary tm-post-title">Comments</h2>
                            <hr class="tm-hr-primary tm-mb-45">
                           
                            <form action="" class="mb-5 tm-comment-form">
                                <h2 class="tm-color-primary tm-post-title mb-4">Your comment</h2>
                                <div class="mb-4">
                                    <input class="form-control" name="name" type="text">
                                </div>
                                <div class="mb-4">
                                    <input class="form-control" name="email" type="text">
                                </div>
                                <div class="mb-4">
                                    <textarea class="form-control" name="message" rows="6"></textarea>
                                </div>
                                <div class="text-right">
                                    <button class="tm-btn tm-btn-primary tm-btn-small">Submit</button>                        
                                </div>                                
                            </form>                          
                        </div>-->
                    </div>
                </div>
            </div>
                <!--<aside class="col-lg-4 tm-aside-col">
                    <div class="tm-post-sidebar">
                        <hr class="mb-3 tm-hr-primary">
                        <h2 class="mb-4 tm-post-title tm-color-primary">Categories</h2>
                        <ul class="tm-mb-75 pl-5 tm-category-list">
                            <li><a href="#" class="tm-color-primary">Visual Designs</a></li>
                            <li><a href="#" class="tm-color-primary">Travel Events</a></li>
                            <li><a href="#" class="tm-color-primary">Web Development</a></li>
                            <li><a href="#" class="tm-color-primary">Video and Audio</a></li>
                            <li><a href="#" class="tm-color-primary">Etiam auctor ac arcu</a></li>
                            <li><a href="#" class="tm-color-primary">Sed im justo diam</a></li>
                        </ul>
                        <hr class="mb-3 tm-hr-primary">
                        <h2 class="tm-mb-40 tm-post-title tm-color-primary">Related Posts</h2>
                        <a href="#" class="d-block tm-mb-40">
                            <figure>
                                <img src="img/capp.png" alt="Image" class="mb-3 img-fluid">
                                <figcaption class="tm-color-primary">Duis mollis diam nec ex viverra scelerisque a sit</figcaption>
                            </figure>
                        </a>
                        <a href="#" class="d-block tm-mb-40">
                            <figure>
                                <img src="img/img-05.jpg" alt="Image" class="mb-3 img-fluid">
                                <figcaption class="tm-color-primary">Integer quis lectus eget justo ullamcorper ullamcorper</figcaption>
                            </figure>
                        </a>
                        <a href="#" class="d-block tm-mb-40">
                            <figure>
                                <img src="img/img-06.jpg" alt="Image" class="mb-3 img-fluid">
                                <figcaption class="tm-color-primary">Nam lobortis nunc sed faucibus commodo</figcaption>
                            </figure>
                        </a>
                    </div>                    
                </aside>-->
            </div>
            <footer class="row tm-row">
               
              <!--  <div class="col-md-6 col-12 tm-color-gray">
                    
                    Design: <a rel="nofollow" target="_parent" href="https://templatemo.com" class="tm-external-link">TemplateMo</a>
                </div>-->
                <!--  <div class="col-md-6 col-12 tm-color-gray tm-copyright">
                    Copyright 2020 Xtra Blog Company Co. Ltd.
                </div>-->
            </footer> 
        </main>
    </div>
    <script src="js/jquery.min.js"></script>
    <script src="js/templatemo-script.js"></script>
</body>
</html>